var p=Object.defineProperty;var V=(e,t,n)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var s=(e,t)=>p(e,"name",{value:t,configurable:!0});var c=(e,t,n)=>(V(e,typeof t!="symbol"?t+"":t,n),n);import{h as g,k as C,y as d,l as m,z as O,A as S,v as $,m as l,t as h,x as b,n as w,F as I,u as v}from"./vue.esm-bundler-c2f1cd55.js";class k{constructor({uuid:t,comment:n,author:o,tags:i,extra_data:u,links:r,created_at:a}){c(this,"uuid");c(this,"comment");c(this,"author");c(this,"tags");c(this,"extra_data");c(this,"links");c(this,"created_at");this.uuid=t,this.comment=n,this.author=o,this.tags=i,this.extra_data=u,this.links=r,this.created_at=new Date(a)}}s(k,"Entry");/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function N(e,t,n){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");typeof t=="function"&&(n=t,t={}),t=t||{},n=n||function(){},i.type=t.type||"text/javascript",i.charset=t.charset||"utf8",i.async="async"in t?!!t.async:!0,i.src=e,t.attrs&&R(i,t.attrs),t.text&&(i.text=String(t.text));var u="onload"in i?E:j;u(i,n),i.onload||E(i,n),o.appendChild(i)}s(N,"loadScript");function R(e,t){for(var n in t)e.setAttribute(n,t[n])}s(R,"setAttributes");function E(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}s(E,"stdOnEnd");function j(e,t){e.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,t(null,e))}}s(j,"ieOnEnd");var f;function y(e,t){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):typeof e!="string"||e.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(f||(f=y.scriptLoader(e).then(function(n){return t&&t(n),n})),f)}s(y,"getEditorNamespace");y.scriptLoader=function(e){return new Promise(function(t,n){N(e,function(o){if(f=void 0,o)return n(o);if(!window.CKEDITOR)return n(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."));t(CKEDITOR)})})};function K(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o;return function(){clearTimeout(o);for(var i=arguments.length,u=new Array(i),r=0;r<i;r++)u[r]=arguments[r];o=setTimeout(e.bind.apply(e,[n].concat(u)),t)}}s(K,"debounce");const B={name:"ckeditor",render(){return g("div",{},[g(this.tagName)])},props:{modelValue:{type:String,default:""},type:{type:String,default:"classic",validator:e=>["classic","inline"].includes(e)},editorUrl:{type:String,default:"https://cdn.ckeditor.com/4.17.2/standard-all/ckeditor.js"},config:{type:Object,default:()=>{}},tagName:{type:String,default:"textarea"},readOnly:{type:Boolean,default:null},throttle:{type:Number,default:80}},mounted(){y(this.editorUrl,e=>{this.$emit("namespaceloaded",e)}).then(()=>{if(this.$_destroyed)return;const e=this.prepareConfig(),t=this.type==="inline"?"inline":"replace",n=this.$el.firstElementChild;CKEDITOR[t](n,e)})},data(){return{readyEmitted:!1}},beforeDestroy(){this.instance&&this.instance.destroy(),this.$_destroyed=!0},watch:{modelValue(e){this.instance&&this.instance.getData()!==e&&this.instance.setData(e)},readOnly(e){this.instance&&this.instance.setReadOnly(e)}},methods:{prepareConfig(){const e=this.config||{};e.on=e.on||{},e.delayIfDetached===void 0&&(e.delayIfDetached=!0),this.readOnly!==null&&(e.readOnly=this.readOnly);const t=e.on.instanceReady;return e.on.instanceReady=n=>{this.instance=n.editor,this.$nextTick().then(()=>{this.prepareComponentData(),t&&t(n)})},e},prepareComponentData(){const e=this.modelValue;this.instance.fire("lockSnapshot"),this.instance.setData(e,{callback:()=>{this.$_setUpEditorEvents();const t=this.instance.getData();e!==t?(this.readyEmitted||(this.$emit("ready",this.instance),console.log("Emitting Ready"),this.readyEmitted=!0),this.$emit("update:modelValue",t)):this.readyEmitted||(this.$emit("ready",this.instance),console.log("Emitting Ready"),this.readyEmitted=!0),this.instance.fire("unlockSnapshot")}})},$_setUpEditorEvents(){const e=this.instance,t=K(n=>{const o=e.getData();this.modelValue!==o&&this.$emit("update:modelValue",o,n,e)},this.throttle);e.on("change",t),e.on("focus",n=>{this.$emit("focus",n,e)}),e.on("blur",n=>{this.$emit("blur",n,e)})}}},_=C({name:"CommentEditor",components:{ckeditor:B},props:{richTextConfig:{type:Object,default:()=>{}},defaultValue:{type:String,default:""}},emits:["cancel","submit"],data:function(){return{value:this.defaultValue}}});const T=s((e,t)=>{const n=e.__vccOpts||e;for(const[o,i]of t)n[o]=i;return n},"_export_sfc"),L=["placeholder"],U={class:"text-right btn-actions"};function F(e,t,n,o,i,u){const r=b("ckeditor");return d(),m("div",null,[e.richTextConfig?(d(),$(r,{key:1,modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value=a),config:e.richTextConfig},null,8,["modelValue","config"])):O((d(),m("textarea",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>e.value=a),class:"form-control",placeholder:e.$t("entry.placeholder")},null,8,L)),[[S,e.value]]),l("div",U,[l("button",{class:"btn btn-sm btn-primary",onClick:t[2]||(t[2]=a=>e.$emit("submit",e.value))},h(e.$t("entry.save_comment")),1),l("button",{class:"btn btn-sm btn-default",onClick:t[3]||(t[3]=a=>e.$emit("cancel"))},h(e.$t("entry.cancel_edit")),1)])])}s(F,"_sfc_render$1");const M=T(_,[["render",F]]);_.__docgenInfo={displayName:"CommentEditor",exportName:"default",description:"",tags:{},props:[{name:"richTextConfig",type:{name:"object"},defaultValue:{func:!0,value:"() => undefined"}},{name:"defaultValue",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"submit"},{name:"cancel"}],sourceFiles:["/home/runner/work/osis-comment/osis-comment/frontend/components/CommentEditor.vue"]};const D=C({name:"CommentEntry",components:{CommentEditor:M},props:{richTextConfig:{type:Object,default:()=>{}},entry:{type:k,required:!0}},emits:["edit","delete"],data:function(){return{isEditing:!1}}});const A={class:"panel-body clearfix"},H={class:"comment-authoring"},P={class:"pull-right comment-actions"},q=["title"],z=l("i",{class:"fas fa-pencil"},null,-1),x=[z],G=["title"],J=l("i",{class:"fas fa-times"},null,-1),Q=[J],W={key:0,class:"comment-content"},X=["innerHTML"],Y=["innerHTML"];function Z(e,t,n,o,i,u){const r=b("CommentEditor");return d(),m("div",A,[l("div",H,[l("strong",null,h(e.entry.author||e.$t("entry.anonymous")),1),w(" "+h(e.$t("entry.authored_date",{date:e.entry.created_at.toLocaleDateString(),time:e.entry.created_at.toLocaleTimeString()})),1)]),e.isEditing?(d(),$(r,{key:1,"default-value":e.entry.comment,"rich-text-config":e.richTextConfig,onSubmit:t[2]||(t[2]=a=>e.$emit("edit",e.entry.links.edit,a)),onCancel:t[3]||(t[3]=a=>e.isEditing=!1)},null,8,["default-value","rich-text-config"])):(d(),m(I,{key:0},[l("div",P,[typeof e.entry.links.edit=="string"?(d(),m("button",{key:0,class:"btn btn-sm btn-primary",title:e.$t("entry.edit_comment"),onClick:t[0]||(t[0]=a=>e.isEditing=!0)},x,8,q)):v("",!0),typeof e.entry.links.delete=="string"?(d(),m("button",{key:1,class:"btn btn-sm btn-danger",title:e.$t("entry.delete_comment"),onClick:t[1]||(t[1]=a=>e.$emit("delete",e.entry.links.delete))},Q,8,G)):v("",!0)]),e.richTextConfig?(d(),m("div",{key:1,class:"comment-content",innerHTML:e.entry.comment},null,8,Y)):(d(),m("div",W,[l("p",{innerHTML:e.entry.comment.replace(/\n/g,"<br/>")},null,8,X)]))],64))])}s(Z,"_sfc_render");const ne=T(D,[["render",Z]]);D.__docgenInfo={displayName:"CommentEntry",exportName:"default",description:"",tags:{},props:[{name:"richTextConfig",type:{name:"object"},defaultValue:{func:!0,value:"() => undefined"}},{name:"entry",type:{name:"Entry"},required:!0}],events:[{name:"delete"},{name:"edit"}],sourceFiles:["/home/runner/work/osis-comment/osis-comment/frontend/components/CommentEntry.vue"]};export{M as C,k as E,T as _,ne as a};
//# sourceMappingURL=CommentEntry-7fe36378.js.map
