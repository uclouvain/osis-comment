var p=Object.defineProperty;var O=(e,t,n)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var s=(e,t)=>p(e,"name",{value:t,configurable:!0});var l=(e,t,n)=>(O(e,typeof t!="symbol"?t+"":t,n),n);import{h as g,k as C,y as d,l as c,z as w,A as S,v as $,m as u,t as h,x as b,n as I,F as N,u as v}from"./vue.esm-bundler-c2f1cd55.js";class k{constructor({uuid:t,comment:n,author:o,tags:i,extra_data:m,links:r,created_at:a,modified_at:V}){l(this,"uuid");l(this,"comment");l(this,"author");l(this,"tags");l(this,"extra_data");l(this,"links");l(this,"created_at");l(this,"modified_at");this.uuid=t,this.comment=n,this.author=o,this.tags=i,this.extra_data=m,this.links=r,this.created_at=new Date(a),this.modified_at=new Date(V)}}s(k,"Entry");/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function R(e,t,n){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");typeof t=="function"&&(n=t,t={}),t=t||{},n=n||function(){},i.type=t.type||"text/javascript",i.charset=t.charset||"utf8",i.async="async"in t?!!t.async:!0,i.src=e,t.attrs&&j(i,t.attrs),t.text&&(i.text=String(t.text));var m="onload"in i?E:K;m(i,n),i.onload||E(i,n),o.appendChild(i)}s(R,"loadScript");function j(e,t){for(var n in t)e.setAttribute(n,t[n])}s(j,"setAttributes");function E(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}s(E,"stdOnEnd");function K(e,t){e.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,t(null,e))}}s(K,"ieOnEnd");var f;function y(e,t){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):typeof e!="string"||e.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(f||(f=y.scriptLoader(e).then(function(n){return t&&t(n),n})),f)}s(y,"getEditorNamespace");y.scriptLoader=function(e){return new Promise(function(t,n){R(e,function(o){if(f=void 0,o)return n(o);if(!window.CKEDITOR)return n(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."));t(CKEDITOR)})})};function B(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o;return function(){clearTimeout(o);for(var i=arguments.length,m=new Array(i),r=0;r<i;r++)m[r]=arguments[r];o=setTimeout(e.bind.apply(e,[n].concat(m)),t)}}s(B,"debounce");const L={name:"ckeditor",render(){return g("div",{},[g(this.tagName)])},props:{modelValue:{type:String,default:""},type:{type:String,default:"classic",validator:e=>["classic","inline"].includes(e)},editorUrl:{type:String,default:"https://cdn.ckeditor.com/4.17.2/standard-all/ckeditor.js"},config:{type:Object,default:()=>{}},tagName:{type:String,default:"textarea"},readOnly:{type:Boolean,default:null},throttle:{type:Number,default:80}},mounted(){y(this.editorUrl,e=>{this.$emit("namespaceloaded",e)}).then(()=>{if(this.$_destroyed)return;const e=this.prepareConfig(),t=this.type==="inline"?"inline":"replace",n=this.$el.firstElementChild;CKEDITOR[t](n,e)})},data(){return{readyEmitted:!1}},beforeDestroy(){this.instance&&this.instance.destroy(),this.$_destroyed=!0},watch:{modelValue(e){this.instance&&this.instance.getData()!==e&&this.instance.setData(e)},readOnly(e){this.instance&&this.instance.setReadOnly(e)}},methods:{prepareConfig(){const e=this.config||{};e.on=e.on||{},e.delayIfDetached===void 0&&(e.delayIfDetached=!0),this.readOnly!==null&&(e.readOnly=this.readOnly);const t=e.on.instanceReady;return e.on.instanceReady=n=>{this.instance=n.editor,this.$nextTick().then(()=>{this.prepareComponentData(),t&&t(n)})},e},prepareComponentData(){const e=this.modelValue;this.instance.fire("lockSnapshot"),this.instance.setData(e,{callback:()=>{this.$_setUpEditorEvents();const t=this.instance.getData();e!==t?(this.readyEmitted||(this.$emit("ready",this.instance),console.log("Emitting Ready"),this.readyEmitted=!0),this.$emit("update:modelValue",t)):this.readyEmitted||(this.$emit("ready",this.instance),console.log("Emitting Ready"),this.readyEmitted=!0),this.instance.fire("unlockSnapshot")}})},$_setUpEditorEvents(){const e=this.instance,t=B(n=>{const o=e.getData();this.modelValue!==o&&this.$emit("update:modelValue",o,n,e)},this.throttle);e.on("change",t),e.on("focus",n=>{this.$emit("focus",n,e)}),e.on("blur",n=>{this.$emit("blur",n,e)})}}},_=C({name:"CommentEditor",components:{ckeditor:L},props:{richTextConfig:{type:Object,default:()=>{}},defaultValue:{type:String,default:""}},emits:["cancel","submit"],data:function(){return{value:this.defaultValue}}});const T=s((e,t)=>{const n=e.__vccOpts||e;for(const[o,i]of t)n[o]=i;return n},"_export_sfc"),U=["placeholder"],F={class:"text-right btn-actions"};function M(e,t,n,o,i,m){const r=b("ckeditor");return d(),c("div",null,[e.richTextConfig?(d(),$(r,{key:1,modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value=a),config:e.richTextConfig},null,8,["modelValue","config"])):w((d(),c("textarea",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>e.value=a),class:"form-control",placeholder:e.$t("entry.placeholder")},null,8,U)),[[S,e.value]]),u("div",F,[u("button",{class:"btn btn-sm btn-primary",onClick:t[2]||(t[2]=a=>e.$emit("submit",e.value))},h(e.$t("entry.save_comment")),1),u("button",{class:"btn btn-sm btn-default",onClick:t[3]||(t[3]=a=>e.$emit("cancel"))},h(e.$t("entry.cancel_edit")),1)])])}s(M,"_sfc_render$1");const A=T(_,[["render",M]]);_.__docgenInfo={displayName:"CommentEditor",exportName:"default",description:"",tags:{},props:[{name:"richTextConfig",type:{name:"object"},defaultValue:{func:!0,value:"() => undefined"}},{name:"defaultValue",type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"submit"},{name:"cancel"}],sourceFiles:["/home/runner/work/osis-comment/osis-comment/frontend/components/CommentEditor.vue"]};const D=C({name:"CommentEntry",components:{CommentEditor:A},props:{richTextConfig:{type:Object,default:()=>{}},entry:{type:k,required:!0}},emits:["edit","delete"],data:function(){return{isEditing:!1}}});const H={class:"panel-body clearfix"},P={class:"comment-authoring"},q={class:"pull-right comment-actions"},z=["title"],x=u("i",{class:"fas fa-pencil"},null,-1),G=[x],J=["title"],Q=u("i",{class:"fas fa-times"},null,-1),W=[Q],X={key:0,class:"comment-content"},Y=["innerHTML"],Z=["innerHTML"];function ee(e,t,n,o,i,m){const r=b("CommentEditor");return d(),c("div",H,[u("div",P,[u("strong",null,h(e.entry.author||e.$t("entry.anonymous")),1),I(" "+h(e.$t("entry.authored_date",{date:e.entry.modified_at.toLocaleDateString(),time:e.entry.modified_at.toLocaleTimeString()})),1)]),e.isEditing?(d(),$(r,{key:1,"default-value":e.entry.comment,"rich-text-config":e.richTextConfig,onSubmit:t[2]||(t[2]=a=>e.$emit("edit",e.entry.links.edit,a)),onCancel:t[3]||(t[3]=a=>e.isEditing=!1)},null,8,["default-value","rich-text-config"])):(d(),c(N,{key:0},[u("div",q,[typeof e.entry.links.edit=="string"?(d(),c("button",{key:0,class:"btn btn-sm btn-primary",title:e.$t("entry.edit_comment"),onClick:t[0]||(t[0]=a=>e.isEditing=!0)},G,8,z)):v("",!0),typeof e.entry.links.delete=="string"?(d(),c("button",{key:1,class:"btn btn-sm btn-danger",title:e.$t("entry.delete_comment"),onClick:t[1]||(t[1]=a=>e.$emit("delete",e.entry.links.delete))},W,8,J)):v("",!0)]),e.richTextConfig?(d(),c("div",{key:1,class:"comment-content",innerHTML:e.entry.comment},null,8,Z)):(d(),c("div",X,[u("p",{innerHTML:e.entry.comment.replace(/\n/g,"<br/>")},null,8,Y)]))],64))])}s(ee,"_sfc_render");const ie=T(D,[["render",ee]]);D.__docgenInfo={displayName:"CommentEntry",exportName:"default",description:"",tags:{},props:[{name:"richTextConfig",type:{name:"object"},defaultValue:{func:!0,value:"() => undefined"}},{name:"entry",type:{name:"Entry"},required:!0}],events:[{name:"delete"},{name:"edit"}],sourceFiles:["/home/runner/work/osis-comment/osis-comment/frontend/components/CommentEntry.vue"]};export{A as C,k as E,T as _,ie as a};
//# sourceMappingURL=CommentEntry-bef07900.js.map
