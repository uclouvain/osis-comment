{"version":3,"file":"osis-comment.umd.min.js","sources":["../../../frontend/i18n.ts","../../../frontend/types.ts","../../../node_modules/ckeditor4-integrations-common/dist/index.esm.js","../../../frontend/components/ckeditor.js","../../../frontend/components/CommentEditor.vue","../../../frontend/components/CommentEntry.vue","../../../node_modules/mitt/dist/mitt.mjs","../../../frontend/event-bus.ts","../../../frontend/CommentThread.vue","../../../frontend/components/CommentCount.vue","../../../frontend/main.ts"],"sourcesContent":["/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\nimport {createI18n} from 'vue-i18n';\nimport en from \"./locales/en\";\nimport fr from \"./locales/fr\";\n\nexport const i18n = createI18n({\n  locale: document.documentElement.lang || 'en',\n  messages: {\n    en,\n    fr,\n  },\n});\n","import type {CommentLinks, EntryRecord} from \"./interfaces\";\n\nexport class Entry {\n  uuid: string;\n  comment: string;\n  author: string | null;\n  tags: string[];\n  extra_data: object;\n  links: CommentLinks;\n\n  created_at: Date;\n  modified_at: Date;\n\n  constructor(\n      {\n        uuid,\n        comment,\n        author,\n        tags,\n        extra_data,\n        links,\n        created_at,\n        modified_at,\n      }: EntryRecord,\n  ) {\n    this.uuid = uuid;\n    this.comment = comment;\n    this.author = author;\n    this.tags = tags;\n    this.extra_data = extra_data;\n    this.links = links;\n    this.created_at = new Date(created_at);\n    this.modified_at = new Date(modified_at);\n  }\n}\n","/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */\nfunction loadScript (src, opts, cb) {\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var script = document.createElement('script');\n  if (typeof opts === 'function') {\n    cb = opts;\n    opts = {};\n  }\n  opts = opts || {};\n  cb = cb || function () {};\n  script.type = opts.type || 'text/javascript';\n  script.charset = opts.charset || 'utf8';\n  script.async = 'async' in opts ? !!opts.async : true;\n  script.src = src;\n  if (opts.attrs) {\n    setAttributes(script, opts.attrs);\n  }\n  if (opts.text) {\n    script.text = String(opts.text);\n  }\n  var onend = 'onload' in script ? stdOnEnd : ieOnEnd;\n  onend(script, cb);\n  if (!script.onload) {\n    stdOnEnd(script, cb);\n  }\n  head.appendChild(script);\n}\nfunction setAttributes(script, attrs) {\n  for (var attr in attrs) {\n    script.setAttribute(attr, attrs[attr]);\n  }\n}\nfunction stdOnEnd(script, cb) {\n  script.onload = function () {\n    this.onerror = this.onload = null;\n    cb(null, script);\n  };\n  script.onerror = function () {\n    this.onerror = this.onload = null;\n    cb(new Error('Failed to load ' + this.src), script);\n  };\n}\nfunction ieOnEnd(script, cb) {\n  script.onreadystatechange = function () {\n    if (this.readyState != 'complete' && this.readyState != 'loaded') {\n      return;\n    }\n    this.onreadystatechange = null;\n    cb(null, script);\n  };\n}\n\nvar promise;\nfunction getEditorNamespace(editorURL, onNamespaceLoaded) {\n  if ('CKEDITOR' in window) {\n    return Promise.resolve(CKEDITOR);\n  }\n  if (typeof editorURL !== 'string' || editorURL.length < 1) {\n    return Promise.reject(new TypeError('CKEditor URL must be a non-empty string.'));\n  }\n  if (!promise) {\n    promise = getEditorNamespace.scriptLoader(editorURL).then(function (res) {\n      if (onNamespaceLoaded) {\n        onNamespaceLoaded(res);\n      }\n      return res;\n    });\n  }\n  return promise;\n}\ngetEditorNamespace.scriptLoader = function (editorURL) {\n  return new Promise(function (scriptResolve, scriptReject) {\n    loadScript(editorURL, function (err) {\n      promise = undefined;\n      if (err) {\n        return scriptReject(err);\n      } else if (!window.CKEDITOR) {\n        return scriptReject(new Error('Script loaded from editorUrl doesn\\'t provide CKEDITOR namespace.'));\n      }\n      scriptResolve(CKEDITOR);\n    });\n  });\n};\n\nfunction debounce(fn, delay) {\n  var context = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var cancel;\n  return function () {\n    clearTimeout(cancel);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    cancel = setTimeout(fn.bind.apply(fn, [context].concat(args)), delay);\n  };\n}\n\nexport { debounce, getEditorNamespace };\n","/*\n *\n * OSIS stands for Open Student Information System. It's an application\n * designed to manage the core business of higher education institutions,\n * such as universities, faculties, institutes and professional schools.\n * The core business involves the administration of students, teachers,\n * courses, programs and so on.\n *\n * Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * A copy of this license - GNU General Public License - is available\n * at the root of the source code of this program.  If not,\n * see http://www.gnu.org/licenses/.\n *\n */\n\n/* global CKEDITOR */\n\n/**\n * This is taken from https://github.com/mayasabha/ckeditor4-vue3/blob/master/src/ckeditor.js\n * but as https://github.com/mayasabha/ckeditor4-vue3/issues/5\n * tree shaking is broken and the dist package ships with vue, hence we reproduce it in our own code\n */\n\n\nimport { h } from 'vue';\nimport { debounce, getEditorNamespace } from 'ckeditor4-integrations-common';\n\nexport default {\n\tname: 'ckeditor',\n\n\trender() {\n\t\treturn h( 'div', {}, [\n\t\t\th( this.tagName )\n\t\t] );\n\t},\n\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: 'classic',\n\t\t\tvalidator: type => [ 'classic', 'inline' ].includes( type )\n\t\t},\n\t\teditorUrl: {\n\t\t\ttype: String,\n\t\t\tdefault: 'https://cdn.ckeditor.com/4.17.2/standard-all/ckeditor.js'\n\t\t},\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {}\n\t\t},\n\t\ttagName: {\n\t\t\ttype: String,\n\t\t\tdefault: 'textarea'\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: null // Use null as the default value, so `config.readOnly` can take precedence.\n\t\t},\n\t\tthrottle: {\n\t\t\ttype: Number,\n\t\t\tdefault: 80\n\t\t}\n\t},\n\n\tmounted() {\n\t\tgetEditorNamespace( this.editorUrl, namespace => {\n\t\t\tthis.$emit( 'namespaceloaded', namespace );\n\t\t} ).then( () => {\n\t\t\tif ( this.$_destroyed ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst config = this.prepareConfig();\n\t\t\tconst method = this.type === 'inline' ? 'inline' : 'replace';\n\t\t\tconst element = this.$el.firstElementChild;\n\n\t\t\tCKEDITOR[ method ]( element, config );\n\t\t} );\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\treadyEmitted: false,\n\t\t};\n\t},\n\n\tbeforeDestroy() {\n\t\tif ( this.instance ) {\n\t\t\tthis.instance.destroy();\n\t\t}\n\n\t\tthis.$_destroyed = true;\n\t},\n\n\twatch: {\n\t\tmodelValue( val ) {\n\t\t\tif ( this.instance && this.instance.getData() !== val ) {\n\t\t\t\tthis.instance.setData( val );\n\t\t\t}\n\t\t},\n\n\t\treadOnly( val ) {\n\t\t\tif ( this.instance ) {\n\t\t\t\tthis.instance.setReadOnly( val );\n\t\t\t}\n\t\t}\n\t},\n\n\tmethods: {\n\t\tprepareConfig() {\n\t\t\tconst config = this.config || {};\n\t\t\tconfig.on = config.on || {};\n\n\t\t\tif ( config.delayIfDetached === undefined ) {\n\t\t\t\tconfig.delayIfDetached = true;\n\t\t\t}\n\t\t\tif ( this.readOnly !== null ) {\n\t\t\t\tconfig.readOnly = this.readOnly;\n\t\t\t}\n\n\t\t\tconst userInstanceReadyCallback = config.on.instanceReady;\n\n\t\t\tconfig.on.instanceReady = evt => {\n\t\t\t\tthis.instance = evt.editor;\n\n\t\t\t\tthis.$nextTick().then( () => {\n\t\t\t\t\tthis.prepareComponentData();\n\n\t\t\t\t\tif ( userInstanceReadyCallback ) {\n\t\t\t\t\t\tuserInstanceReadyCallback( evt );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\treturn config;\n\t\t},\n\t\tprepareComponentData() {\n\t\t\tconst data = this.modelValue;\n\n\t\t\tthis.instance.fire( 'lockSnapshot' );\n\n\t\t\tthis.instance.setData( data, { callback: () => {\n\t\t\t\tthis.$_setUpEditorEvents();\n\n\t\t\t\tconst newData = this.instance.getData();\n\n\t\t\t\t// Locking the snapshot prevents the 'change' event.\n\t\t\t\t// Trigger it manually to update the bound data.\n\t\t\t\tif ( data !== newData ) {\n\t\t\t\t\t/* this.$on( 'input', () => {\n\t\t\t\t\t\tthis.$emit( 'ready', this.instance );\n\t\t\t\t\t} ); */\n\t\t\t\t\tif (!this.readyEmitted) {\n\t\t\t\t\t\tthis.$emit( 'ready', this.instance );\n\t\t\t\t\t\tconsole.log('Emitting Ready');\n\t\t\t\t\t\tthis.readyEmitted = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit( 'update:modelValue', newData );\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.readyEmitted) {\n\t\t\t\t\t\tthis.$emit( 'ready', this.instance );\n\t\t\t\t\t\tconsole.log('Emitting Ready');\n\t\t\t\t\t\tthis.readyEmitted = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.instance.fire( 'unlockSnapshot' );\n\t\t\t} } );\n\t\t},\n\t\t$_setUpEditorEvents() {\n\t\t\tconst editor = this.instance;\n\n\t\t\tconst onChange = debounce( evt => {\n\t\t\t\tconst data = editor.getData();\n\n\t\t\t\t// Editor#change event might be fired without an actual data change.\n\t\t\t\tif ( this.modelValue !== data ) {\n\t\t\t\t\t// The compatibility with the v-model and general Vue.js concept of input–like components.\n\t\t\t\t\tthis.$emit( 'update:modelValue', data, evt, editor );\n\t\t\t\t}\n\t\t\t}, this.throttle );\n\n\t\t\teditor.on( 'change', onChange );\n\n\t\t\teditor.on( 'focus', evt => {\n\t\t\t\tthis.$emit( 'focus', evt, editor );\n\t\t\t} );\n\n\t\t\teditor.on( 'blur', evt => {\n\t\t\t\tthis.$emit( 'blur', evt, editor );\n\t\t\t} );\n\t\t}\n\t}\n};\n","<!--\n  -\n  - OSIS stands for Open Student Information System. It's an application\n  - designed to manage the core business of higher education institutions,\n  - such as universities, faculties, institutes and professional schools.\n  - The core business involves the administration of students, teachers,\n  - courses, programs and so on.\n  -\n  - Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU General Public License as published by\n  - the Free Software Foundation, either version 3 of the License, or\n  - (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU General Public License for more details.\n  -\n  - A copy of this license - GNU General Public License - is available\n  - at the root of the source code of this program.  If not,\n  - see http://www.gnu.org/licenses/.\n  -\n  -->\n<template>\n  <div>\n    <textarea\n        v-if=\"!richTextConfig\"\n        v-model=\"value\"\n        class=\"form-control\"\n        :placeholder=\"$t('entry.placeholder')\"\n    />\n    <ckeditor\n        v-else\n        v-model=\"value\"\n        :config=\"richTextConfig\"\n    />\n    <div class=\"text-right btn-actions\">\n      <button\n          class=\"btn btn-sm btn-primary\"\n          @click=\"$emit('submit', value)\"\n      >\n        {{ $t('entry.save_comment') }}\n      </button>\n      <button\n          class=\"btn btn-sm btn-default\"\n          @click=\"$emit('cancel')\"\n      >\n        {{ $t('entry.cancel_edit') }}\n      </button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport component from './ckeditor.js';\nimport {defineComponent} from 'vue';\nimport type {Component} from 'vue';\n\nexport default defineComponent({\n  name: 'CommentEditor',\n  components: {\n    ckeditor: (component as Component),\n  },\n  props: {\n    richTextConfig: {\n      type: Object,\n      default: () => undefined,\n    },\n    defaultValue: {\n      type: String,\n      default: '',\n    },\n  },\n  emits: ['cancel', 'submit'],\n  data: function () {\n    return {\n      value: this.defaultValue,\n    };\n  },\n});\n</script>\n\n\n<style>\n  .btn-actions {\n    margin-top: .5em;\n  }\n  .btn-actions > button {\n    margin-left: .3em;\n  }\n</style>\n","<!--\n  -\n  - OSIS stands for Open Student Information System. It's an application\n  - designed to manage the core business of higher education institutions,\n  - such as universities, faculties, institutes and professional schools.\n  - The core business involves the administration of students, teachers,\n  - courses, programs and so on.\n  -\n  - Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU General Public License as published by\n  - the Free Software Foundation, either version 3 of the License, or\n  - (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU General Public License for more details.\n  -\n  - A copy of this license - GNU General Public License - is available\n  - at the root of the source code of this program.  If not,\n  - see http://www.gnu.org/licenses/.\n  -\n  -->\n\n<template>\n  <div class=\"panel-body clearfix\">\n    <div class=\"comment-authoring\">\n      <strong>{{ entry.author || $t('entry.anonymous') }}</strong>\n      {{\n        $t('entry.authored_date', {\n          date: entry.modified_at.toLocaleDateString(),\n          time: entry.modified_at.toLocaleTimeString(),\n        })\n      }}\n    </div>\n    <template v-if=\"!isEditing\">\n      <div class=\"pull-right comment-actions\">\n        <button\n            v-if=\"typeof entry.links.edit === 'string'\"\n            class=\"btn btn-sm btn-primary\"\n            :title=\"$t('entry.edit_comment')\"\n            @click=\"isEditing = true\"\n        >\n          <i class=\"fas fa-pencil\" />\n        </button>\n        <button\n            v-if=\"typeof entry.links.delete === 'string'\"\n            class=\"btn btn-sm btn-danger\"\n            :title=\"$t('entry.delete_comment')\"\n            @click=\"$emit('delete', entry.links.delete)\"\n        >\n          <i class=\"fas fa-times\" />\n        </button>\n      </div>\n      <div\n          v-if=\"!richTextConfig\"\n          class=\"comment-content\"\n      >\n        <!-- eslint-disable vue/no-v-html -->\n        <p v-html=\"entry.comment.replace(/\\n/g, '<br/>')\" />\n      </div>\n      <!-- eslint-disable vue/no-v-html -->\n      <div\n          v-else\n          class=\"comment-content\"\n          v-html=\"entry.comment\"\n      />\n    </template>\n    <CommentEditor\n        v-else\n        :default-value=\"entry.comment\"\n        :rich-text-config=\"richTextConfig\"\n        @submit=\"(value) => $emit('edit', entry.links.edit, value)\"\n        @cancel=\"isEditing = false\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {Entry} from '../types';\nimport CommentEditor from './CommentEditor.vue';\nimport {defineComponent} from \"vue\";\n\nexport default defineComponent({\n  name: 'CommentEntry',\n  components: {CommentEditor},\n  props: {\n    richTextConfig: {\n      type: Object,\n      default: () => undefined,\n    },\n    entry: {\n      type: Entry,\n      required: true,\n    },\n  },\n  emits: ['edit', 'delete'],\n  data: function () {\n    return {\n      isEditing: false,\n    };\n  },\n});\n</script>\n\n<style>\n.comment-authoring {\n  background: #dddddd;\n  padding: .5em 1em;\n}\n\n.comment-content {\n  padding: 1em 0;\n}\n\n.comment-actions {\n  padding: 4px 0;\n}\n\n.comment-actions > button {\n  margin-left: .3em;\n  min-width: 34px;\n  min-height: 34px;\n}\n</style>\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i?i.push(e):n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var i=n.get(t);i&&i.slice().map(function(n){n(e)}),(i=n.get(\"*\"))&&i.slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.mjs.map\n","import mitt from 'mitt';\n\nconst EventBus = mitt();\n\nexport default EventBus;\n\n","<!--\n  -\n  - OSIS stands for Open Student Information System. It's an application\n  - designed to manage the core business of higher education institutions,\n  - such as universities, faculties, institutes and professional schools.\n  - The core business involves the administration of students, teachers,\n  - courses, programs and so on.\n  -\n  - Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU General Public License as published by\n  - the Free Software Foundation, either version 3 of the License, or\n  - (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU General Public License for more details.\n  -\n  - A copy of this license - GNU General Public License - is available\n  - at the root of the source code of this program.  If not,\n  - see http://www.gnu.org/licenses/.\n  -\n  -->\n\n<template>\n  <div\n      class=\"comment-thread panel\"\n      :class=\"`panel-${panelClass}`\"\n  >\n    <div class=\"panel-heading clearfix\">\n      {{ headerTitle || $t('thread.title') }}\n      <template v-if=\"total != null\">\n        ({{ total }})\n      </template>\n      <button\n          class=\"btn btn-default btn-sm pull-right\"\n          @click=\"changeSort()\"\n      >\n        {{ $t('thread.sort') }}\n        <i\n            class=\"fas\"\n            :class=\"isAscendedSort ? 'fa-sort-up' : 'fa-sort-down'\"\n        />\n      </button>\n    </div>\n    <span\n        v-if=\"loading\"\n        class=\"spinner\"\n    />\n    <div\n        v-else-if=\"error\"\n        class=\"panel-body text-danger\"\n    >\n      {{ error }}\n    </div>\n    <CommentEntry\n        v-for=\"entry in entries\"\n        v-else\n        :key=\"entry.uuid\"\n        :entry=\"entry\"\n        :rich-text-config=\"richTextConfig\"\n        @edit=\"editEntry\"\n        @delete=\"deleteEntry\"\n    />\n    <div\n        v-if=\"nextPage || previousPage || createUrl\"\n        class=\"panel-body\"\n    >\n      <button\n          v-if=\"previousPage\"\n          class=\"btn btn-sm btn-default\"\n          @click=\"previousPage && (currentUrl = previousPage); loadEntries()\"\n      >\n        <i class=\"fas fa-chevron-left\" />\n        {{ $t('thread.previous') }}\n      </button>\n      <button\n          v-if=\"nextPage\"\n          class=\"btn btn-sm btn-default\"\n          @click=\"nextPage && (currentUrl = nextPage); loadEntries()\"\n      >\n        {{ $t('thread.next') }}\n        <i class=\"fas fa-chevron-right\" />\n      </button>\n      <template v-if=\"createUrl\">\n        <button\n            v-if=\"!isAdding\"\n            class=\"btn btn-sm btn-primary pull-right\"\n            @click=\"isAdding = !isAdding\"\n        >\n          <i class=\"fas fa-plus\" />\n          {{ $t('thread.add_comment') }}\n        </button>\n        <CommentEditor\n            v-else\n            :rich-text-config=\"richTextConfig\"\n            @submit=\"createEntry\"\n            @cancel=\"isAdding = !isAdding\"\n        />\n      </template>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport CommentEntry from './components/CommentEntry.vue';\nimport {Entry} from './types';\nimport type {EntriesResponse} from './interfaces';\nimport CommentEditor from './components/CommentEditor.vue';\nimport type {PropType} from \"vue\";\nimport EventBus from './event-bus';\nimport {defineComponent} from \"vue\";\n\nexport default defineComponent({\n  name: 'CommentThread',\n  components: {CommentEditor, CommentEntry},\n  props: {\n    url: {\n      type: String,\n      required: true,\n    },\n    tags: {\n      type: Array as PropType<string[]>,\n      default: () => [],\n    },\n    headerTitle: {\n      type: String,\n      default: '',\n    },\n    pageSize: {\n      type: Number,\n      default: 10,\n    },\n    defaultSort: {\n      type: String,\n      default: '-modified_at',\n    },\n    panelClass: {\n      type: String,\n      default: 'default',\n    },\n    richTextConfig: {\n      type: Object,\n      default: () => undefined,\n    },\n  },\n  data() {\n    const params = new URLSearchParams({\n      limit: String(this.pageSize),\n      sort: '-modified_at',\n    });\n    if (this.tags.length) {\n      params.append('tags', this.tags.join(','));\n    }\n    const element = document.querySelector('[name=csrfmiddlewaretoken]');\n    if (!(element instanceof HTMLInputElement)) {\n      throw new Error('Please include {% csrf_token %} in your page.');\n    }\n    return {\n      entries: [] as Entry[],\n      error: '',\n      total: null as number | null,\n      createUrl: null as string | null,\n      currentUrl: `${this.url}?${params.toString()}`,\n      currentSort: '-modified_at',\n      previousPage: null as string | null,\n      nextPage: null as string | null,\n      loading: true,\n      isAdding: false,\n      csrfToken: element.value,\n    };\n  },\n  computed: {\n    isAscendedSort: function (): boolean {\n      return this.currentSort === 'modified_at';\n    },\n  },\n  mounted() {\n    void this.loadEntries();\n  },\n  methods: {\n    async changeSort() {\n      const url = new URL(window.location.origin + this.currentUrl);\n      const params = new URLSearchParams(url.search);\n      this.currentSort = this.isAscendedSort ? '-modified_at' : 'modified_at';\n      params.set('sort', this.currentSort);\n      this.currentUrl = `${url.pathname}?${params.toString()}`;\n      await this.loadEntries();\n    },\n    async loadEntries() {\n      const data = (await this.doRequest(this.currentUrl, {}, false)) as EntriesResponse;\n      if (data) {\n        this.createUrl = typeof data.create === 'string' ? data.create : null;\n        this.previousPage = data.previous;\n        this.nextPage = data.next;\n        this.total = data.count;\n        this.entries = data.results.map(r => new Entry(r));\n      }\n    },\n    async createEntry(value: string) {\n      await this.doRequest(this.createUrl as string, {\n        method: 'POST',\n        body: JSON.stringify({comment: value, tags: this.tags}),\n      });\n      this.isAdding = false;\n    },\n    async editEntry(url: string, value: string) {\n      await this.doRequest(url, {\n        method: 'PUT',\n        body: JSON.stringify({comment: value}),\n      });\n    },\n    async deleteEntry(url: string) {\n      await this.doRequest(url, {method: 'DELETE'});\n    },\n    async doRequest(url: string, params: object, refresh = true) {\n      this.loading = true;\n      this.error = '';\n      try {\n        const response = await fetch(url, {\n          mode: 'same-origin',\n          headers: {\n            'Content-Type': 'application/json;charset=utf-8',\n            'X-CSRFToken': this.csrfToken,\n          },\n          ...params,\n        });\n        if (response.status >= 200 && response.status < 300) {\n          if (refresh) {\n            await this.loadEntries();\n            EventBus.emit(\"REFRESH_COMMENTS_EVENT\");\n          }\n          this.loading = false;\n          return response.json();\n        } else {\n          this.error = response.statusText;\n        }\n      } catch (e) {\n        this.error = (e as Error).message;\n      }\n      this.loading = false;\n    },\n  },\n});\n</script>\n\n<style>\n.comment-thread .panel-heading {\n  line-height: 30px;\n}\n</style>\n","<!--\n  -\n  - OSIS stands for Open Student Information System. It's an application\n  - designed to manage the core business of higher education institutions,\n  - such as universities, faculties, institutes and professional schools.\n  - The core business involves the administration of students, teachers,\n  - courses, programs and so on.\n  -\n  - Copyright (C) 2015-2023 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU General Public License as published by\n  - the Free Software Foundation, either version 3 of the License, or\n  - (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU General Public License for more details.\n  -\n  - A copy of this license - GNU General Public License - is available\n  - at the root of the source code of this program.  If not,\n  - see http://www.gnu.org/licenses/.\n  -\n  -->\n<template>\n  <div>\n    <div class=\"badge badge-compteur\">\n      {{ value }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent} from 'vue';\nimport {type EntriesResponse} from \"../interfaces\";\nimport EventBus from \"../event-bus\";\n\nexport default defineComponent({\n  name: 'CommentCount',\n  props: {\n    url: {\n      type: String,\n      required: true,\n    },\n  },\n  data: function () {\n    return {\n      value: null as number | null,\n      loading: true,\n      error: '',\n    };\n  },\n  mounted() {\n    void this.loadCount();\n    EventBus.on(\"REFRESH_COMMENTS_EVENT\",() => void this.loadCount());\n  },\n  methods: {\n    async loadCount() {\n      const data = (await this.doRequest(this.url, {}, false)) as EntriesResponse;\n      if (data) {\n        this.value = data.count;\n      }\n    },\n    async doRequest(url: string, params: object, refresh = true) {\n      this.loading = true;\n      this.error = '';\n      try {\n        const response = await fetch(url, {\n          mode: 'same-origin',\n          headers: {\n            'Content-Type': 'application/json;charset=utf-8',\n          },\n          ...params,\n        });\n        if (response.status >= 200 && response.status < 300) {\n          if (refresh) {\n            await this.loadCount();\n          }\n          this.loading = false;\n          return response.json();\n        } else {\n          this.error = response.statusText;\n        }\n      } catch (e) {\n        this.error = (e as Error).message;\n      }\n      this.loading = false;\n    },\n  },\n});\n</script>\n\n\n<style>\n  .badge {\n    display: inline-block;\n    min-width: 10px;\n    padding: 3px 7px;\n    font-size: 12px;\n    font-weight: 700;\n    line-height: 1;\n    color: #fff;\n    text-align: center;\n    white-space: nowrap;\n    vertical-align: middle;\n    background-color: #777;\n    border-radius: 10px;\n  }\n\n  .badge-compteur{\n    margin-left: 5px;\n    font-size: 9px;\n    background-color: #337ab7;\n  }\n</style>\n","/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\nimport {createApp} from '@vue/runtime-dom'; // not importing from 'vue' so it can be spied on\nimport {i18n} from './i18n';\nimport CommentThread from './CommentThread.vue';\nimport CommentCount from \"./components/CommentCount.vue\";\n\ninterface Props extends Record<string, unknown> {\n  url: string,\n  headerTitle?: string,\n  defaultSort?: string,\n  panelClass?: string,\n  richTextConfig?: object,\n  pageSize?: number,\n  tags?: string[],\n}\n\nfunction initCommentComponents() {\n\n  document.querySelectorAll<HTMLElement>('.comment-viewer:not([data-v-app])').forEach((elem) => {\n    const props: Props = {url: \"\", ...elem.dataset};\n    if (typeof elem.dataset.pageSize !== 'undefined') {\n      props.pageSize = Number.parseInt(elem.dataset.pageSize);\n    }\n    if (typeof elem.dataset.tags !== 'undefined') {\n      props.tags = elem.dataset.tags.split(',');\n    }\n    if (typeof elem.dataset.richTextConfig !== 'undefined') {\n      props.richTextConfig = JSON.parse(elem.dataset.richTextConfig) as object;\n    }\n    createApp(CommentThread, props).use(i18n).mount(elem);\n  });\n\n  document.querySelectorAll<HTMLElement>('.comment-count:not([data-v-app])').forEach((elem) => {\n      const props: Props = {url: \"\", ...elem.dataset};\n      createApp(CommentCount, props).mount(elem);\n  });\n}\n\n// Initialize at first load\ninitCommentComponents();\n\n// Initialize later if nodes are added dynamically\nconst observer = new MutationObserver(initCommentComponents);\nobserver.observe(document, {childList: true, subtree: true});\n"],"names":["i18n","createI18n","en","fr","Entry","uuid","comment","author","tags","extra_data","links","created_at","modified_at","__publicField","loadScript","src","opts","cb","head","script","setAttributes","onend","stdOnEnd","ieOnEnd","attrs","attr","promise","getEditorNamespace","editorURL","onNamespaceLoaded","res","scriptResolve","scriptReject","err","debounce","fn","delay","context","cancel","_len","args","_key","component","h","type","namespace","config","method","element","val","userInstanceReadyCallback","evt","data","newData","editor","onChange","_sfc_main$3","defineComponent","_resolveComponent","_openBlock","_createElementBlock","_ctx","_createBlock","_component_ckeditor","_cache","$event","_withDirectives","_hoisted_1","_vModelText","_createElementVNode","_hoisted_2","_toDisplayString","_sfc_main$2","CommentEditor","_hoisted_3","_hoisted_10","_createTextVNode","_component_CommentEditor","value","_Fragment","_hoisted_6","_hoisted_4","_createCommentVNode","_hoisted_12","_hoisted_11","mitt","n","e","i","EventBus","_sfc_main$1","CommentEntry","params","url","r","refresh","response","_normalizeClass","_renderList","entry","_component_CommentEntry","_sfc_main","_sfc_render","$props","$setup","$data","$options","initCommentComponents","elem","props","createApp","CommentThread","CommentCount"],"mappings":"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","x_google_ignoreList":[2,6]}